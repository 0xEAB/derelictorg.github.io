<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Mike Parker">
  
  <title>About Bindings - Derelict Documentation</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  <link href="../extra.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "About Bindings";
    var mkdocs_page_input_path = "bindings.md";
    var mkdocs_page_url = "/bindings/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Derelict Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Introduction</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../support/">Support</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../overview/">Overview</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 current">
        <a class="current" href="./">About Bindings</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#terminology">Terminology</a></li>
                
            
                <li class="toctree-l3"><a href="#dynamic-vs-static-bindings">Dynamic vs. Static Bindings</a></li>
                
                    <li><a class="toctree-l4" href="#static-bindings">Static Bindings</a></li>
                
                    <li><a class="toctree-l4" href="#dynamic-bindings">Dynamic Bindings</a></li>
                
            
                <li class="toctree-l3"><a href="#conclusion">Conclusion</a></li>
                
            
            </ul>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Compiling and Linking</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../building/overview/">Overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../building/with-dub/">When Managing Projects with DUB</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../building/without-dub/">When Managing Projects without DUB</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Loading Shared Libraries</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../loading/loader/">The Derelict Loader</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../loading/failure/">Load Failures</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Derelict Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>About Bindings</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/DerelictOrg" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>The bindings in Derelict are primarily <em>dynamic bindings</em>, as opposed to those in the <a href="https://github.com/D-Programming-Deimos">Deimos project</a> which are all <em>static bindings</em>. This page aims to clarify the difference between the two types of bindings. It is important when starting a new project to understand the implications of each and to select the appropriate type in order to avoid unnecessary frustration.</p>
<h2 id="terminology">Terminology</h2>
<p>Before getting to the differences between the two types of bindings, it would help to understand some relevant terminology as used throughout this documentation. This is especially important since the words <em>static</em> and <em>dynamic</em> are commonly used in multiple contexts. Understanding the terminology will help to avoid confusion in online discussions or when asking for help.</p>
<ul>
<li><strong>binding</strong> -- a direct interface to a library in one language that enables the library to be used in another language. Typically, the binding provides a one-to-one mapping to the original interface. For example, the names of all type and function declarations in the Derelict packages correspond exactly to those declared in the original C libraries, except in cases where the original API uses a variable or type name that is a keyword in D. Bindings are sometimes mistakenly referred to as <em>wrappers</em>.</li>
<li><strong>wrapper</strong> -- a higher-level interface to a library. Wrappers are typically written in the same language as the underlying API, either that of the original library or a binding to that library. For example, a wrapper for OpenGL written in D would be written on top of an OpenGL binding that is also written in D. Wrappers typically provide functionality that makes using the library more convenient. For example, an OpenGL wrapper for D might use classes to represent OpenGL objects such as textures and shaders, encapsulating commonly grouped function calls into single class methods. None of the packages in Derelict are wrappers. They are all bindings. However, D wrappers can be made that use Derelict packages to interface with the C libraries. For example, an OpenGL wrapper can be written on top of <a href="https://github.com/DerelictOrg/DerelictGL3">DerelictGL3</a>.</li>
<li><strong>static linking</strong> -- occurs right after the compile step when building an exectuable with a statically compiled language such as C, C++ or D. All of the object files generated by the compiler are fed to a <em>linker</em>, which <em>links</em> them together, along with any <em>static libraries</em> that the application may need, in order to generate the final executable. A static library is an archive containing precompiled object files that are all combined into the final executable. Static libraries on Windows tend to have the <strong>.lib</strong> file extension; static libraries on Posix systems tend to have <strong>.a</strong> extensions. Since the objects in a static library become a part of the executable, they add to its file size. When new versions of a static library are released with bug fixes and improvements, all applications that use it must be recompiled in order to benefit from them.</li>
<li><strong>dynamic linking</strong> -- as with static linking, this happens just after the compile step when building an executable with a statically compiled language such as C, C++ or D. However, instead of linking with a <em>static library</em>, the linker links with a <em>shared library</em> directly or, on Windows systems, with an <em>import library</em> (which, confusingly, have the same <strong>.lib</strong> file extension as static libraries). Shared libraries are referred to as <em>dynamic link libraries</em> on Windows (usually with the <strong>.dll</strong> extension) and as <em>shared objects</em> on most Posix systems (with the <strong>.so</strong> extension). Along with shared object files, one can also find <em>dynamic libraries</em> with the <strong>.dylib</strong> extension on Mac OS X. Though the names and file formats may be different, all shared libraries are fundamentally the same. Like static libraries, shared libraries are archive files containing precompiled objects. The difference is that they <em>are not</em> combined into the final executable at link time. Instead, information for the system loader is inserted into the executable by the linker. The OS can use this information at run time to load the shared library into memory when the application starts. This allows a single library to be shared by multiple applications, which makes executables smaller and allows all applications using the same library to benefit when the library is updated with bug fixes or improvements, without the need to recompile any of them. It also means that the shared library must be available on the end-user's system in a location that resides on the system library search path.</li>
<li><strong>dynamic loading</strong> -- this is a means of using shared libraries without a link step after compilation. Instead, the shared libraries are loaded manually by the executable at run time. To be clear, dynamic linking has a link-time dependency when the final executable is generated and the OS will automatically load the relevant shared libraries at run time; <em>dynamic loading</em> has no link-time dependency and the executable can be generated by the linker without the shared libraries being present on the system. In order for dynamic loading to work, the program must make use of OS-specific APIs (or third-party wrappers) to load the shared libraries into the process memory space. Since the linker is not used to generate locations in memory for the shared library's symbols, the program must declare pointers to the symbols in the shared library that it wants to use and manually match them with the symbols in the shared library after loading it into memory. In other words, the shared library is loaded manually rather than automatically. The shared library must also be available on the end-user's system in a location that is on the system library search path, otherwise the system APIs will not be able to find it. Aside from eliminating link-time dependencies, this approach allows different implementations of a shared library's interface to be easily swapped at run time.</li>
</ul>
<h2 id="dynamic-vs-static-bindings">Dynamic vs. Static Bindings</h2>
<p>The primary difference between a dynamic and a static binding is that the former has no link-time dependency on the library to which it binds. Both types require that the bindings themselves be either linked with the executable or compiled along with the application. However, static bindings have the additional requirement that the bound library must be either statically linked (with a static library) or dynamically linked (with a shared library) when the executable is generated. Dynamic bindings make use of dynamic loading to load shared libraries at run time and, therefore, have no link-time dependencies beyond the binding itself. This is explained below.</p>
<h3 id="static-bindings">Static Bindings</h3>
<p>The source code for static bindings in D, like those found in the <a href="https://github.com/D-Programming-Deimos">Deimos project</a>, tends to look very similar to the C or C++ headers for the C library to which they bind. Functions are declared with no implementation. For example:</p>
<pre class="code"><code class="language-D">extern(C) void SomeFunction(int);</code></pre>


<p>Given a C library, <strong>MyLib</strong>, which exposes the function <code>SomeFunction</code> declared above, the user of the D binding for <strong>MyLib</strong> must either statically link with the <strong>MyLib</strong> static library (<strong>MyLib.lib</strong> on Windows, <strong>libMylib.a</strong> elsewhere) or with the <strong>MyLib</strong> shared library (the import library <strong>MyLib.lib</strong> on Windows, or <strong>libMyLib.so</strong> elsewhere). Additionally, the user must also link with the <strong>MyLib</strong> binding itself, most often as a static library, if it contains anything more than delcarations, e.g. helper functions that have implementations.</p>
<p>On Windows, there can be some effort required to link with the C library. At issue is the object file format used by different linkers. For example, when compiling on 32-bit Windows, DMD uses the OPTLINK linker by default, which only understands the <a href="http://en.wikipedia.org/wiki/Relocatable_Object_Module_Format">OMF object format</a>. This is the format that was commonly used on Windows back in the DOS days. Modern Windows compilers and linkers more typically use <a href="https://support.microsoft.com/en-us/kb/121460">COFF</a> instead. As such, most precompiled static and shared libraries available online are in the COFF format. To be used with the default 32-bit DMD toolchain, they must either be converted to OMF using a conversion tool, or the source for the library must be compiled with a compiler that generates OMF files, such as the <a href="http://www.digitalmars.com/features.html">Digital Mars C &amp; C++ Compiler (DMC)</a>. However, when compiling with DMD in 64-bit mode, DMD makes use of the Visual C++ toolchain. In this case, the VS linker understands the COFF format, so the conversion step is not necessary. Detailing the object file formats used by every D compiler is beyond the scope of this documentation. It's up to the user to know the output of the tools being used.</p>
<p>Different people may see different benefits and drawbacks to using static bindings. One of the biggest benefits, perhaps, is that a static binding offers a choice between statically linking with and dynamically linking with a C library. However, no matter which type of linking is chosen, there is no way to escape the link-time dependency imposed by a static binding.</p>
<h3 id="dynamic-bindings">Dynamic Bindings</h3>
<p>Not only are dynamic bindings used differently than static bindings, they are implemented differently. Normal function prototypes do not work with dynamic bindings because of the fact that such bindings make use of dynamic loading. All of the functions in the bound library must be declared in the binding as function pointers. The <strong>MyLib</strong> example above converted to a dynamic binding format in D might look something like this:</p>
<pre class="code"><code class="language-D">extern(C) alias p_SomeFunction = void function(int);
p_SomeFunction SomeFunction;</code></pre>


<p>When an application using the <strong>MyLib</strong> dynamic binding is compiled, there is no link-time dependency beyond the binding itself. At run time, the dynamic binding will make a call into the OS API to load the <strong>MyLib</strong> shared library into the application's memory space. After that, it will again call into the OS API to fetch the address of the <code>SomeFunction</code> implementation and assign it to the <code>SomeFunction</code> variable declared above. If successful, then <code>SomeFunction</code> is ready to use from that point on.</p>
<p>Aside from eliminating the link-time dependency on the bound library, dynamic bindings give the user control over the case when the shared library fails to load, an event which typically occurs when the library is missing from the user's system, it's missing some symbols the program expects to find, or is otherwise corrupt. When using a static binding with dynamic linking, the OS itself reports an error in these cases, which may not always be desirable. Because a dynamic binding uses dynamic loading, it is possible for the application to detect such errors and react in a manner appropriate for the application, such as displaying a message box with a link to a tech support page.</p>
<h2 id="conclusion">Conclusion</h2>
<p>The information above is intended to shed light on the difference between static and dynamic bindings. Generally, neither type of binding is "better" than the other. For most applications, it probably doesn't matter which type is used as long as the application programmer is comfortable with the concepts of compiling, linking, and loading. The pros and cons of each approach can take on different weights in different contexts, but debating or explaining such is beyond the scope of this documentation.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../building/overview/" class="btn btn-neutral float-right" title="Overview">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../overview/" class="btn btn-neutral" title="Overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/DerelictOrg" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../overview/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../building/overview/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
